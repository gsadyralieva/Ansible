---
  - name: Install LAMP Stack 
    hosts: development
    tasks:
      - name: Ping hosts
        ping:

      - name: Update packages
        yum: 
          name: '*'
          state: latest

      - name: Install packages on Application server
        when: ansible_hostname == "application"
        yum:
          name:
            - httpd
            - php
            - php-mysql
          state: latest


      - name: Install packages on Database server
        when: ansible_hostname == "database"
        yum:
          name:
            - mariadb-server
            - mariadb
          state: latest

      - name: start apache on application server
        when: ansible_hostname == "application"
        systemd:
          name: httpd
          state: started
          enabled: yes
          
          
      - name: start mariadb on database server
        when: ansible_hostname == "database"
        systemd:
          name: mariadb
          state: started
          enabled: yes
          
      - name: Open port 80
        firewalld:
          service: http
          permanent: true
          state: enabled
          immediate: yes
 
      - name: Open port 443
        firewalld:
          service: https
          permanent: true
          state: enabled
          immediate: yes
          
          
      - name: restart firewalld
        systemd:
          name: firewalld
          state: restarted
